<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="using:FileTransferino.App.ViewModels"
        x:Class="FileTransferino.App.Views.CommandPaletteWindow"
        x:DataType="vm:CommandPaletteViewModel"
        Title="Command Palette"
        Width="600"
        Height="400"
        WindowStartupLocation="CenterOwner"
        CanResize="False"
        Topmost="True"
        Background="{DynamicResource BackgroundBrush}"
        BorderBrush="{DynamicResource BorderBrush}"
        BorderThickness="1">

    <Window.Styles>
        <Style Selector="TextBox">
            <Setter Property="Background" Value="{DynamicResource SurfaceBrush}" />
            <Setter Property="Foreground" Value="{DynamicResource TextPrimaryBrush}" />
            <Setter Property="BorderBrush" Value="{DynamicResource BorderBrush}" />
            <Setter Property="CaretBrush" Value="{DynamicResource TextPrimaryBrush}" />
            <Setter Property="SelectionBrush" Value="{DynamicResource AccentBrush}" />
            <Setter Property="FontSize" Value="{DynamicResource FontSizeBase}" />
        </Style>
        
        <!-- Ensure TextBox background stays consistent -->
        <Style Selector="TextBox /template/ Border#PART_BorderElement">
            <Setter Property="Background" Value="{DynamicResource SurfaceBrush}" />
        </Style>
        
        <!-- Focused TextBox gets a subtle glow -->
        <Style Selector="TextBox:focus /template/ Border#PART_BorderElement">
            <Setter Property="Background" Value="{DynamicResource SurfaceBrush}" />
            <Setter Property="BorderBrush" Value="{DynamicResource AccentHoverBrush}" />
            <Setter Property="BorderThickness" Value="0,0,0,2" />
        </Style>
        
        <!-- Pointer over state -->
        <Style Selector="TextBox:pointerover /template/ Border#PART_BorderElement">
            <Setter Property="Background" Value="{DynamicResource SurfaceBrush}" />
        </Style>
        
        <!-- Watermark text -->
        <Style Selector="TextBox /template/ TextBlock#PART_Watermark">
            <Setter Property="Foreground" Value="{DynamicResource WatermarkBrush}" />
        </Style>
        
        <Style Selector="ListBox">
            <Setter Property="Background" Value="{DynamicResource BackgroundBrush}" />
            <Setter Property="BorderBrush" Value="Transparent" />
        </Style>
        
        <Style Selector="ListBoxItem">
            <Setter Property="Padding" Value="16,10" />
            <Setter Property="Background" Value="Transparent" />
            <Setter Property="BorderThickness" Value="3,0,0,0" />
            <Setter Property="BorderBrush" Value="Transparent" />
        </Style>
        
        <!-- Selected item: subtle highlight with left border -->
        <Style Selector="ListBoxItem:selected">
            <Setter Property="Background" Value="{DynamicResource SurfaceBrush}" />
            <Setter Property="BorderBrush" Value="{DynamicResource AccentBrush}" />
        </Style>
        
        <!-- Hover: subtle background -->
        <Style Selector="ListBoxItem:pointerover">
            <Setter Property="Background" Value="{DynamicResource AccentHoverBrush}" />
        </Style>
        
        <Style Selector="TextBlock.commandName">
            <Setter Property="Foreground" Value="{DynamicResource TextPrimaryBrush}" />
            <Setter Property="FontSize" Value="{DynamicResource FontSizeBase}" />
            <Setter Property="FontWeight" Value="Medium" />
        </Style>
        
        <Style Selector="TextBlock.commandCategory">
            <Setter Property="Foreground" Value="{DynamicResource TextSecondaryBrush}" />
            <Setter Property="FontSize" Value="{DynamicResource FontSizeSmall}" />
        </Style>
    </Window.Styles>

    <DockPanel>
        <!-- Search Box -->
        <TextBox DockPanel.Dock="Top"
                 Text="{Binding SearchText}"
                 Watermark="Type to search commands..."
                 Padding="12"
                 FontSize="16"
                 BorderThickness="0,0,0,1"
                 x:Name="SearchBox" />

        <!-- Command List -->
        <ListBox x:Name="CommandList"
                 ItemsSource="{Binding FilteredCommands}"
                 SelectedItem="{Binding SelectedCommand}"
                 BorderThickness="0"
                 Margin="0">
            <ListBox.ItemTemplate>
                <DataTemplate>
                    <StackPanel Spacing="4">
                        <TextBlock Text="{Binding Name}" 
                                   Classes="commandName" />
                        <TextBlock Text="{Binding Category}" 
                                   Classes="commandCategory" />
                    </StackPanel>
                </DataTemplate>
            </ListBox.ItemTemplate>
        </ListBox>
    </DockPanel>
</Window>
